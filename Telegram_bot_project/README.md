# Telegram Movie Search Bot

Этот проект представляет собой Telegram-бота, который позволяет пользователю искать фильмы по запросу, используя OMDB API. Бот предоставляет команды для поиска, работы с историей запросов и другие функциональные возможности. Все данные сохраняются в базе данных PostgreSQL, а пользователь может просматривать историю своих запросов.


## 1. Установка и настройка окружения

### 1.1. Установка Python и PostgreSQL

Убедитесь, что на вашей машине установлены:

- **Python**: версия 3.10 или выше.
- **PostgreSQL**: Проверьте с помощью команд:
  - `python3 --version`
  - `psql --version`


### 1.2. Установка зависимостей

1. Создайте виртуальное окружение:
   - `python3 -m venv myenv`
2. Активируйте виртуальное окружение:
   - `source myenv/bin/activate` (для Linux/macOS) или `myenv\Scripts\activate` (для Windows)
3. Установите зависимости с помощью pip:
   - `pip install -r requirements.txt`


### 1.3. Настройка PostgreSQL

1. Создайте базу данных PostgreSQL для проекта:
   - `psql -U postgres`
   - `CREATE DATABASE telegram_bot_project;`
2. Убедитесь, что параметры подключения указаны в файле `.env`:
   - `DATABASE_URL=postgres://postgres:mysecretpassword@localhost:5432/telegram_bot_project`


## 2. Настройка базы данных

Для работы с базой данных используется **Peewee ORM**. База данных включает таблицы для хранения истории поисковых запросов. Проверьте файл `services/database.py`, чтобы убедиться, что структура базы данных настроена корректно. Выполните инициализацию базы данных, используя соответствующий скрипт:

- `python3 services/database.py`


## 3. Настройка Telegram бота

### 3.1. Получение токена для Telegram бота

1. Откройте Telegram и найдите **BotFather**.
2. Начните диалог с **BotFather**, введя команду `/start`.
3. Введите команду `/newbot`, чтобы создать нового бота.
4. Следуйте инструкциям:
   - Укажите имя для вашего бота.
   - Укажите уникальное имя пользователя для бота, которое должно заканчиваться на **bot**.
5. После успешного создания **BotFather** отправит вам токен.
6. Сохраните токен в файл `.env`:
   - `BOT_TOKEN=7435739347:AAGYrh-QD1o1m44GGddlTRC_OLJiQi_KI2s`


### 3.2. Получение ключа API OMDB

1. Перейдите на сайт OMDB API.
2. Зарегистрируйтесь, создав аккаунт, и получите ключ API. После успешной регистрации на указанный вами email будет отправлено сообщение с ключом API.

Пример письма:

Here is your key: 8e8e0fa6

Please append it to all of your API requests,

OMDb API: http://www.omdbapi.com/?i=tt3896198&apikey=8e8e0fa6

Click the following URL to activate your key: http://www.omdbapi.com/apikey.aspx?VERIFYKEY=afbfcf14-b79d-4c3d-9f93-68006fd6b0b4

If you did not make this request, please disregard this email.


3. Скопируйте ваш ключ API и сохраните его в файл `.env` вашего проекта:
   - `OMDB_API_KEY=8e8e0fa6`


## 4. Запуск проекта

Запустите бота с помощью соответствующей команды для запуска Python-скрипта:

- `python3 search_assistant_bot.py`


## 5. Основные команды

- **/start** — Начать работу с ботом. При активации бот приветствует пользователя и предлагает команды для использования.
- **/search** — Позволяет пользователю искать фильмы по названию с использованием OMDB API.
- **/search_year** — Позволяет пользователю искать фильмы по названию и году.
- **/history** — Позволяет пользователю просматривать историю своих поисковых запросов.
- **/delete** — Очищает историю запросов в базе данных.


## 6. Описание функционала

- **Поиск фильмов**: Бот позволяет пользователю вводить текстовые запросы для поиска фильмов (по названию или по названию с годом) и предоставляет результаты, соответствующие запросу.
- **История запросов**: Все поисковые запросы сохраняются в базе данных PostgreSQL, и пользователи могут просматривать историю своих запросов.
- **Очистка истории**: Команда **/delete** позволяет очистить историю запросов.


## 7. Пример работы бота

### Пример 1: Поиск фильма по названию

Пользователь запускает бота командой **/start**. Бот приветствует и предоставляет доступные команды:
Затем пользователь вводит команду **/search_year** для поиска фильма. Бот запрашивает название фильма:

![Поиск фильма по названию](https://github.com/NurkenSS/python_basic_diploma/raw/main/telegram_bot_project/Материалы/Бот.png)


### Пример 2: Поиск фильма по названию на браузер

Пользователь нажимает на ссылку **Ссылка на фильм: IMDb** и переходит в браузер, где может найти фильм и ознакомиться с его подробностями.

![Ссылка на фильм: IMDb](https://github.com/NurkenSS/python_basic_diploma/raw/main/telegram_bot_project/Материалы/Кино.png)


### Пример 3: Просмотр истории поисков

Пользователь вводит команду **/history**, и бот выводит список всех ранее выполненных поисковых запросов. Если год не указан, то он не отображается в выводе.

![История запросов](https://github.com/NurkenSS/python_basic_diploma/raw/main/telegram_bot_project/Материалы/История.png)


### Пример 4: Очистка истории запросов

Пользователь вводит команду **/delete**, и бот очищает историю поисковых запросов.

![Очистка истории запросов](https://github.com/NurkenSS/python_basic_diploma/raw/main/telegram_bot_project/Материалы/Очистить.png)
